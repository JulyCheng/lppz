<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>登录</title>
</head>
<link rel="shortcut icon" href="imgs/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="./css/base.css">
<link rel="stylesheet" href="./css/regist.css" />
<body>
    <div class="header"></div>
    <div class="logo"></div>
    <div class="regist">
        <form action="" method="post" onsubmit=login()>
            <div class="item item-wrap phone-wrap">
                <input type="text" name="phone" id="phone" value="" data-validate="false" placeholder="手机号码" />
                <span class="error-msg">手机号码不合法</span>
            </div>
            <div class="item item-wrap pwd-wrap">
                <input type="password" name="pwd" id="pwd" value="" placeholder="6-20位密码" data-validate="false" />
                <span class="error-msg">密码不合法</span>
            </div>

            <button type="submit" id="btn">登陆</button>
        </form>
        <div class="signed-link">还没有账号？
            <a href="regist.html">马上注册</a>
        </div>
    </div>
    <script src="./js/jquery-3.2.1.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/login.js" type="text/javascript" charset="utf-8"></script>
    <script>
        function login(e) {
            e = e || event;
            e.preventDefault();
            let phone = document.getElementById('phone').value;
            let pwd = document.getElementById('pwd').value;
            let data = {
                phone,
                pwd
            }
            sessionStorage.setItem("user1",JSON.stringify(data));
            fetch(
                "http://localhost:3001/users/login", 
                {
                    method: 'post',
                    body: JSON.stringify(data)
                })
                    .then(resp => resp.json())
                    .then(data=>{
                        console.log(data.status);
                        if(data.status){
                            let form=document.getElementsByTagName('form')[0];
                            form.reset();
                            window.location.href="lppzShopping.html"
                        }

                    })
                    .catch(e => console.log(e))
            
        }
    </script>
</body>

</html>